#coding:utf-8
from jinja2 import Environment
from jinja2 import PackageLoader
from datetime import datetime

def reportGenerator(returns=None):
    env = Environment(loader=PackageLoader('result',encoding='utf-8'))
    template = env.get_template('my_template.j2')
    titles=['#','title','assert','retCode','interfaceName','jsonParams','interfaceURL','retContent']
    # returns=[["获取用户信息","成功：返回内容包含陈元露","200","getUser","http://192.168.105.235:80/v0.1/users/38",'{"birthday":"1990-07-31T00:00:00.000-04:00","preferences":[{"field_key":"qq","field_value":null},{"field_key":"we_chat","field_value":"c15525472211"}],"address":"重庆","gender":"0","user_image":null,"user_name":"陈元露","work_phone":"48818546","created_at":"2018-09-01T00:00:00.000-04:00","classification":null,"created_by":"刘诗雨","cell_phone":"15683795676","user_code":"KF20180023","updated_at":null,"user_id":38,"org_id":21,"updated_by":null,"position":null,"identity_no":null,"org_name":"四级组织4","org_code":"ORG011","email":"123456789@qq.com","status":0}'
    # ],["获取用户信息","成功：返回内容包含陈元露","200","getUser","http://192.168.105.235:80/v0.1/users/38",'{"birthday":"1990-07-31T00:00:00.000-04:00","preferences":[{"field_key":"qq","field_value":null},{"field_key":"we_chat","field_value":"c15525472211"}],"address":"重庆","gender":"0","user_image":null,"user_name":"陈元露","work_phone":"48818546","created_at":"2018-09-01T00:00:00.000-04:00","classification":null,"created_by":"刘诗雨","cell_phone":"15683795676","user_code":"KF20180023","updated_at":null,"user_id":38,"org_id":21,"updated_by":null,"position":null,"identity_no":null,"org_name":"四级组织4","org_code":"ORG011","email":"123456789@qq.com","status":0}'
    # ],["获取用户信息","成功：返回内容包含陈元露","200","getUser","http://192.168.105.235:80/v0.1/users/38",'{"birthday":"1990-07-31T00:00:00.000-04:00","preferences":[{"field_key":"qq","field_value":null},{"field_key":"we_chat","field_value":"c15525472211"}],"address":"重庆","gender":"0","user_image":null,"user_name":"陈元露","work_phone":"48818546","created_at":"2018-09-01T00:00:00.000-04:00","classification":null,"created_by":"刘诗雨","cell_phone":"15683795676","user_code":"KF20180023","updated_at":null,"user_id":38,"org_id":21,"updated_by":null,"position":null,"identity_no":null,"org_name":"四级组织4","org_code":"ORG011","email":"123456789@qq.com","status":0}'
    # ],["获取用户信息","失败：返回内容包含陈元露","200","getUser","http://192.168.105.235:80/v0.1/users/38",'{"birthday":"1990-07-31T00:00:00.000-04:00","preferences":[{"field_key":"qq","field_value":null},{"field_key":"we_chat","field_value":"c15525472211"}],"address":"重庆","gender":"0","user_image":null,"user_name":"陈元露","work_phone":"48818546","created_at":"2018-09-01T00:00:00.000-04:00","classification":null,"created_by":"刘诗雨","cell_phone":"15683795676","user_code":"KF20180023","updated_at":null,"user_id":38,"org_id":21,"updated_by":null,"position":null,"identity_no":null,"org_name":"四级组织4","org_code":"ORG011","email":"123456789@qq.com","status":0}'
    # ],["获取用户信息","成功：返回内容包含陈元露","200","getUser","http://192.168.105.235:80/v0.1/users/38",'{"birthday":"1990-07-31T00:00:00.000-04:00","preferences":[{"field_key":"qq","field_value":null},{"field_key":"we_chat","field_value":"c15525472211"}],"address":"重庆","gender":"0","user_image":null,"user_name":"陈元露","work_phone":"48818546","created_at":"2018-09-01T00:00:00.000-04:00","classification":null,"created_by":"刘诗雨","cell_phone":"15683795676","user_code":"KF20180023","updated_at":null,"user_id":38,"org_id":21,"updated_by":null,"position":null,"identity_no":null,"org_name":"四级组织4","org_code":"ORG011","email":"123456789@qq.com","status":0}'
    # ],["获取用户信息","成功：返回内容包含陈元露","200","getUser","http://192.168.105.235:80/v0.1/users/38",'{"birthday":"1990-07-31T00:00:00.000-04:00","preferences":[{"field_key":"qq","field_value":null},{"field_key":"we_chat","field_value":"c15525472211"}],"address":"重庆","gender":"0","user_image":null,"user_name":"陈元露","work_phone":"48818546","created_at":"2018-09-01T00:00:00.000-04:00","classification":null,"created_by":"刘诗雨","cell_phone":"15683795676","user_code":"KF20180023","updated_at":null,"user_id":38,"org_id":21,"updated_by":null,"position":null,"identity_no":null,"org_name":"四级组织4","org_code":"ORG011","email":"123456789@qq.com","status":0}'
    # ],["获取用户信息","失败：返回内容包含陈元露","200","getUser","http://192.168.105.235:80/v0.1/users/38",'{"birthday":"1990-07-31T00:00:00.000-04:00","preferences":[{"field_key":"qq","field_value":null},{"field_key":"we_chat","field_value":"c15525472211"}],"address":"重庆","gender":"0","user_image":null,"user_name":"陈元露","work_phone":"48818546","created_at":"2018-09-01T00:00:00.000-04:00","classification":null,"created_by":"刘诗雨","cell_phone":"15683795676","user_code":"KF20180023","updated_at":null,"user_id":38,"org_id":21,"updated_by":null,"position":null,"identity_no":null,"org_name":"四级组织4","org_code":"ORG011","email":"123456789@qq.com","status":0}'
    # ],["获取用户信息","成功：返回内容包含陈元露","200","getUser","http://192.168.105.235:80/v0.1/users/38",'{"birthday":"1990-07-31T00:00:00.000-04:00","preferences":[{"field_key":"qq","field_value":null},{"field_key":"we_chat","field_value":"c15525472211"}],"address":"重庆","gender":"0","user_image":null,"user_name":"陈元露","work_phone":"48818546","created_at":"2018-09-01T00:00:00.000-04:00","classification":null,"created_by":"刘诗雨","cell_phone":"15683795676","user_code":"KF20180023","updated_at":null,"user_id":38,"org_id":21,"updated_by":null,"position":null,"identity_no":null,"org_name":"四级组织4","org_code":"ORG011","email":"123456789@qq.com","status":0}'
    # ],["获取用户信息","成功：返回内容包含陈元露","200","getUser","http://192.168.105.235:80/v0.1/users/38",'{"birthday":"1990-07-31T00:00:00.000-04:00","preferences":[{"field_key":"qq","field_value":null},{"field_key":"we_chat","field_value":"c15525472211"}],"address":"重庆","gender":"0","user_image":null,"user_name":"陈元露","work_phone":"48818546","created_at":"2018-09-01T00:00:00.000-04:00","classification":null,"created_by":"刘诗雨","cell_phone":"15683795676","user_code":"KF20180023","updated_at":null,"user_id":38,"org_id":21,"updated_by":null,"position":null,"identity_no":null,"org_name":"四级组织4","org_code":"ORG011","email":"123456789@qq.com","status":0}'
    # ],["获取用户信息","成功：返回内容包含陈元露","200","getUser","http://192.168.105.235:80/v0.1/users/38",'{"birthday":"1990-07-31T00:00:00.000-04:00","preferences":[{"field_key":"qq","field_value":null},{"field_key":"we_chat","field_value":"c15525472211"}],"address":"重庆","gender":"0","user_image":null,"user_name":"陈元露","work_phone":"48818546","created_at":"2018-09-01T00:00:00.000-04:00","classification":null,"created_by":"刘诗雨","cell_phone":"15683795676","user_code":"KF20180023","updated_at":null,"user_id":38,"org_id":21,"updated_by":null,"position":null,"identity_no":null,"org_name":"四级组织4","org_code":"ORG011","email":"123456789@qq.com","status":0}'
    # ]
    # ]
    html=template.render(titleList=titles, resListSet=returns)
    now=datetime.strftime(datetime.now(),'%Y%m%d%H%M%S')
    name="report_"+now+".html"
    with open(name,'w') as f:
        f.writelines(html)


if __name__=="__main__":
    reportGenerator()